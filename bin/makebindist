#!/bin/sh

. $(dirname $0)/version

echo ------------------------------------------------------------
echo Making binary distribution of Rage, version $RAGEVERSION
echo ------------------------------------------------------------

RAGE=rage-$RAGEVERSION

# Make sure examples are cleaned
make clean

make

make doc
rm -rf doc/api/latex
mv doc/api/html/* doc/api
rmdir doc/api/html

# Generate README file
(cd README-files/ && m4 README.bindist) > README

mkdir -p $RAGE
cp -r include lib examples doc README $RAGE
rm README
rm $RAGE/doc/api/Doxyfile
cp Makefile.bindist $RAGE/Makefile
tar cjvf $RAGE.tar.bz2 $RAGE
zip -r $RAGE.zip $RAGE
rm -rf $RAGE
mkdir -p ../releases
mv $RAGE.tar.bz2 $RAGE.zip ../releases
